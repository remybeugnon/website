<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu de Noël - Snake</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: 'Arial', sans-serif;
            background-color: #1c1c1c;
            background-image: url('https://www.transparenttextures.com/patterns/snowflakes.png');
            background-size: cover;
            color: white;
        }

        h1 {
            font-size: 3em;
            color: #ff6347;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin: 0;
        }

        p {
            font-size: 1.5em;
            color: #32cd32;
            margin-top: 20px;
        }

        #game {
            display: grid;
            grid-template-columns: repeat(15, 20px); /* 15x15 grid */
            grid-template-rows: repeat(15, 20px);    /* 15x15 grid */
            gap: 1px;
            width: 300px;  /* Adjusted width for 15x15 grid */
            height: 300px; /* Adjusted height for 15x15 grid */
            background-color: #8b0000;
            border: 3px solid #fff;
            border-radius: 15px;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            margin-top: 20px;
        }

        .cell {
            width: 20px;
            height: 20px;
            background-color: #f0f8ff;
        }

        .snake {
            background-color: #32cd32;
        }

        .food {
            background-color: #ff4500;
        }

        #score {
            font-size: 1.5em;
            margin-top: 20px;
        }

        #secretMessage {
            display: none;
            color: gold;
            font-size: 1.5em;
            margin-top: 30px;
        }

        .snowflake {
            position: absolute;
            top: -10px;
            left: 50%;
            font-size: 2em;
            color: white;
            animation: fall 5s linear infinite;
        }

        @keyframes fall {
            0% { top: -10px; opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }
    </style>
</head>
<body>

<h1>Jeu de Noël - Attrapez les Pommes !</h1>
<p>Collectez les pommes pour découvrir un secret de Noël !</p>
<div id="game"></div>
<p id="score">Score: 0</p>
<div id="secretMessage">
    Félicitations ! Vous avez débloqué la page secrète de Noël ! <br>
    <a href="liste.html" style="color: gold;">Cliquez ici pour découvrir le secret !</a>
</div>

<!-- Snowflakes effect -->
<script>
    function generateSnowflakes() {
        for (let i = 0; i < 50; i++) {
            const snowflake = document.createElement('div');
            snowflake.classList.add('snowflake');
            snowflake.style.left = `${Math.random() * 100}vw`;
            snowflake.style.animationDuration = `${Math.random() * 5 + 5}s`; // Snowflakes fall at different speeds
            snowflake.style.animationDelay = `${Math.random() * 10}s`; // Some delay before they start falling
            document.body.appendChild(snowflake);
        }
    }

    generateSnowflakes();
</script>

<script>
    const gameBoard = document.getElementById("game");
    const scoreElement = document.getElementById("score");
    const secretMessage = document.getElementById("secretMessage");

    const gridSize = 15;  // Updated grid size to 15x15
    let snake = [{ x: 7, y: 7 }]; // Center the snake in the middle of the grid
    let food = { x: Math.floor(Math.random() * (gridSize - 2)) + 1, y: Math.floor(Math.random() * (gridSize - 2)) + 1 };
    let direction = { x: 0, y: 0 };
    let nextDirection = { x: 0, y: 0 };
    let score = 0;
    let gameInterval;

    // Initialize the board
    function initBoard() {
        gameBoard.innerHTML = "";
        for (let i = 0; i < gridSize * gridSize; i++) {
            const cell = document.createElement("div");
            cell.classList.add("cell");
            gameBoard.appendChild(cell);
        }
    }

    // Update the board with snake and food
    function updateBoard() {
        initBoard();
        
        // Render snake
        snake.forEach(segment => {
            const index = segment.y * gridSize + segment.x;
            gameBoard.children[index].classList.add("snake");
        });

        // Render food
        const foodIndex = food.y * gridSize + food.x;
        gameBoard.children[foodIndex].classList.add("food");
    }

    // Move the snake
    function moveSnake() {
        direction = nextDirection;
        const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };

        // Check for collision with walls or itself
        if (head.x < 0 || head.x >= gridSize || head.y < 0 || head.y >= gridSize ||
            snake.some(segment => segment.x === head.x && segment.y === head.y)) {
            resetGame();
            return;
        }

        // Check if snake eats food
        if (head.x === food.x && head.y === food.y) {
            score += 10;
            scoreElement.textContent = "Score: " + score;
            spawnFood();
        } else {
            snake.pop(); // Remove the last segment if no food is eaten
        }

        snake.unshift(head);

        // Check if score reaches 50 and stop the game
        if (score === 50) {
            clearInterval(gameInterval); // Stop the game
            secretMessage.style.display = 'block'; // Show the link and secret message
        }
    }

    // Reset game without prompt
    function resetGame() {
        clearInterval(gameInterval);
        score = 0;
        snake = [{ x: 7, y: 7 }];
        direction = { x: 0, y: 0 };
        nextDirection = { x: 0, y: 0 };
        scoreElement.textContent = "Score: " + score;
        spawnFood();
        gameInterval = setInterval(gameLoop, 200);
    }

    // Generate new food position (avoiding the borders)
    function spawnFood() {
        do {
            food = {
                x: Math.floor(Math.random() * (gridSize - 2)) + 1, // x between 1 and gridSize-2
                y: Math.floor(Math.random() * (gridSize - 2)) + 1  // y between 1 and gridSize-2
            };
        } while (snake.some(segment => segment.x === food.x && segment.y === food.y)); // Ensure food doesn't spawn on the snake
    }

    // Control snake direction
    function changeDirection(event) {
        switch (event.key) {
            case "ArrowUp":
                if (direction.y === 0) nextDirection = { x: 0, y: -1 };
                break;
            case "ArrowDown":
                if (direction.y === 0) nextDirection = { x: 0, y: 1 };
                break;
            case "ArrowLeft":
                if (direction.x === 0) nextDirection = { x: -1, y: 0 };
                break;
            case "ArrowRight":
                if (direction.x === 0) nextDirection = { x: 1, y: 0 };
                break;
        }
    }

    // Main game loop
    function gameLoop() {
        moveSnake();
        updateBoard();
    }

    // Start game
    document.addEventListener("keydown", changeDirection);

    initBoard();
    spawnFood();
    updateBoard();
    gameInterval = setInterval(gameLoop, 200);
</script>

</body>
</html>
